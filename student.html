<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>MyClass2 - Ø§Ù„Ø·Ø§Ù„Ø¨ (Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ù…Ø·ÙˆØ±)</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* ØªÙ… Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨ØªØµÙ…ÙŠÙ…Ùƒ Ø§Ù„Ø£ØµÙ„ÙŠ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ 100% Ø¨Ø¯ÙˆÙ† Ø£ÙŠ Ø­Ø°Ù */
:root{--bl:#3b82f6;--rd:#ef4444;--gn:#22c55e;--yw:#f59e0b;--dk:#0f172a;--cd:#1e293b;--br:#334155;--mt:#475569;--dm:#94a3b8}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Cairo',sans-serif}
html,body{height:100%;overflow:hidden;background:var(--dk);color:#fff}

/* â”€â”€ JOIN â”€â”€ */
#overlay{position:fixed;inset:0;background:var(--dk);display:flex;align-items:center;justify-content:center;z-index:9999}
.jcard{background:var(--cd);border:1px solid var(--br);border-radius:24px;padding:40px 28px;width:310px;text-align:center}
.jlogo{font-size:30px;font-weight:900;color:var(--bl)}.jlogo span{color:#fff}
.jsub{font-size:13px;color:var(--dm);margin:6px 0 24px}
.jcard input{width:100%;padding:12px 16px;background:var(--br);border:1px solid var(--mt);border-radius:12px;color:#fff;font-size:15px;font-family:'Cairo',sans-serif;text-align:center;outline:none;margin-bottom:12px}
.jcard input:focus{border-color:var(--bl)}
.jbtn{width:100%;padding:12px;background:var(--bl);border:none;border-radius:12px;color:#fff;font-size:15px;font-weight:700;cursor:pointer;font-family:'Cairo',sans-serif}
.jbtn:disabled{opacity:.5}
.jwait{display:none;margin-top:14px;color:var(--yw);font-size:13px}

/* â”€â”€ APP SHELL â”€â”€ */
#app{position:fixed;inset:0;display:flex;flex-direction:column}

/* â”€â”€ TOPBAR â”€â”€ */
.topbar{background:var(--cd);height:48px;padding:0 12px;display:flex;align-items:center;justify-content:space-between;border-bottom:2px solid var(--br);flex-shrink:0}
.logo{font-size:17px;font-weight:900;color:var(--bl)}.logo span{color:#fff}
.tr{display:flex;align-items:center;gap:8px}
.nchip{background:var(--br);padding:4px 12px;border-radius:20px;font-size:12px}
.hbtn{width:36px;height:36px;border-radius:50%;border:none;background:var(--br);color:#fff;cursor:pointer;font-size:14px;display:flex;align-items:center;justify-content:center}
.hbtn.up{background:var(--yw);animation:pulse 1.5s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.6}}

/* â”€â”€ BOARDS â”€â”€ */
.boards{flex:1;display:flex;flex-direction:column;overflow:hidden;min-height:0;padding:6px;gap:6px}
.bcard{flex:1;background:var(--cd);border-radius:12px;border:1px solid var(--br);display:flex;flex-direction:column;overflow:hidden;min-height:0}
.bhead{height:34px;padding:0 10px;background:var(--br);display:flex;align-items:center;justify-content:space-between;flex-shrink:0;border-bottom:2px solid transparent}
.tb-board .bhead{border-bottom-color:var(--rd)}.sb-board .bhead{border-bottom-color:var(--bl)}
.bhtitle{font-size:12px;font-weight:700;display:flex;align-items:center;gap:6px}
.carea{flex:1;background:#fff;position:relative;overflow:hidden;min-height:0}
.carea canvas{display:block;position:absolute;top:0;left:0;width:100%;height:100%}
#sc{touch-action:none;cursor:crosshair}
.live-badge{background:var(--rd);padding:2px 7px;border-radius:8px;font-size:10px;display:none;align-items:center;gap:4px}
.live-badge.on{display:flex}

/* â”€â”€ MIC BAR â”€â”€ */
.micbar{background:var(--cd);border-top:1px solid var(--br);padding:8px 12px;display:flex;align-items:center;gap:10px;flex-shrink:0}
.micbtn{width:44px;height:44px;border-radius:50%;border:none;background:var(--br);color:var(--dm);cursor:pointer;font-size:18px;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:.2s}
.micbtn.req{background:rgba(245,158,11,.2);color:var(--yw);animation:pulse 1s infinite}
.micbtn.spk{background:var(--gn);color:#fff;animation:pulse 1s infinite}
.miclbl{font-size:13px;color:var(--dm);flex:1}
.volbox{display:flex;align-items:center;gap:6px;flex-shrink:0}
.volbox i{font-size:11px;color:var(--dm)}
input.vol{width:70px;height:4px;-webkit-appearance:none;background:var(--mt);border-radius:2px}
input.vol::-webkit-slider-thumb{-webkit-appearance:none;width:14px;height:14px;background:var(--bl);border-radius:50%;cursor:pointer}

/* â”€â”€ DRAW TOOLBAR â”€â”€ */
.toolbar{background:var(--cd);border-top:1px solid var(--br);padding:6px 10px;display:flex;align-items:center;gap:6px;flex-shrink:0;overflow-x:auto}
.tsep{width:1px;height:32px;background:var(--br);flex-shrink:0}
.tg{display:flex;gap:3px;flex-shrink:0}
.tt{width:36px;height:36px;border-radius:8px;border:1px solid transparent;background:var(--br);color:var(--dm);cursor:pointer;font-size:14px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.tt.on{background:var(--bl);color:#fff}
.clrs{display:flex;gap:4px;align-items:center;flex-shrink:0}
.cl{width:26px;height:26px;border-radius:50%;cursor:pointer;border:2px solid transparent;flex-shrink:0}
.cl.on{border-color:#fff}
.szs{display:flex;gap:3px;background:var(--br);padding:3px 6px;border-radius:8px;flex-shrink:0}
.sz{border:none;background:transparent;cursor:pointer;padding:3px 5px;border-radius:5px;display:flex;align-items:center;justify-content:center}
.sz.on{background:var(--bl)}.sdot{background:#fff;border-radius:50%}

/* â”€â”€ STATUS â”€â”€ */
.sbar{background:var(--cd);border-top:1px solid var(--br);height:26px;padding:0 10px;display:flex;align-items:center;justify-content:space-between;font-size:10px;color:var(--dm);flex-shrink:0}
.conn{display:flex;align-items:center;gap:4px}.cdot{width:6px;height:6px;border-radius:50%;background:var(--gn)}
.tspk{color:var(--rd);display:none;align-items:center;gap:4px;font-weight:700}.tspk.on{display:flex}
</style>
</head>
<body>

<div id="overlay">
  <div class="jcard">
    <div class="jlogo">My<span>Class</span>2</div>
    <p class="jsub">Ø§Ù†Ø¶Ù… Ù„Ù„Ø­ØµØ© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</p>
    <input type="text" id="nameInput" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ" maxlength="25" onkeydown="if(event.key==='Enter')joinClass()">
    <button class="jbtn" id="joinBtn" onclick="joinClass()">
      <i class="fas fa-sign-in-alt"></i> Ø·Ù„Ø¨ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…
    </button>
    <div class="jwait" id="waitMsg">
      <i class="fas fa-spinner fa-spin"></i> ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ù…Ø¯Ø±Ø³...
    </div>
  </div>
</div>

<div id="app">
  <div class="topbar">
    <div class="logo">My<span>Class</span>2</div>
    <div class="tr">
      <span class="nchip" id="dispName"></span>
      <button class="hbtn" id="handBtn" onclick="toggleHand()">
        <i class="fas fa-hand-paper"></i>
      </button>
    </div>
  </div>

  <div class="boards">
    <div class="bcard tb-board">
      <div class="bhead">
        <div class="bhtitle">
          <i class="fas fa-chalkboard-teacher" style="color:var(--rd)"></i>Ø³Ø¨ÙˆØ±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³
        </div>
        <div class="live-badge" id="liveBadge"><i class="fas fa-circle"></i> Ù…Ø¨Ø§Ø´Ø±</div>
      </div>
      <div class="carea" id="tcarea"><canvas id="tc"></canvas></div>
    </div>
    <div class="bcard sb-board">
      <div class="bhead">
        <div class="bhtitle">
          <i class="fas fa-pencil-alt" style="color:var(--bl)"></i>Ø³Ø¨ÙˆØ±ØªÙŠ
        </div>
      </div>
      <div class="carea" id="scarea"><canvas id="sc"></canvas></div>
    </div>
  </div>

  <div class="micbar">
    <button class="micbtn" id="micBtn" onclick="doMic()">
      <i class="fas fa-microphone-slash" id="micIco"></i>
    </button>
    <span class="miclbl" id="micLbl">Ø§Ø¶ØºØ· Ù„Ø·Ù„Ø¨ Ø§Ù„Ù…Ø§ÙŠÙƒ</span>
    <div class="volbox">
      <i class="fas fa-volume-down"></i>
      <input type="range" class="vol" min="0" max="100" value="80" oninput="document.getElementById('AP').volume=this.value/100">
      <i class="fas fa-volume-up"></i>
    </div>
  </div>

  <div class="toolbar">
    <div class="tg">
      <button class="tt on" id="bpen" onclick="setTool('pen')"><i class="fas fa-pencil-alt"></i></button>
      <button class="tt" id="bera" onclick="setTool('eraser')"><i class="fas fa-eraser"></i></button>
    </div>
    <div class="tsep"></div>
    <div class="clrs">
      <div class="cl on" style="background:#1a1a1a" data-c="#1a1a1a" onclick="setClr(this)"></div>
      <div class="cl"    style="background:#ef4444" data-c="#ef4444" onclick="setClr(this)"></div>
      <div class="cl"    style="background:#3b82f6" data-c="#3b82f6" onclick="setClr(this)"></div>
      <div class="cl"    style="background:#22c55e" data-c="#22c55e" onclick="setClr(this)"></div>
      <div class="cl"    style="background:#f59e0b" data-c="#f59e0b" onclick="setClr(this)"></div>
    </div>
    <div class="tsep"></div>
    <div class="szs">
      <button class="sz"    onclick="setSz(2,this)"><div class="sdot" style="width:4px;height:4px"></div></button>
      <button class="sz on" onclick="setSz(5,this)"><div class="sdot" style="width:8px;height:8px"></div></button>
      <button class="sz"    onclick="setSz(12,this)"><div class="sdot" style="width:14px;height:14px"></div></button>
    </div>
    <div class="tsep"></div>
    <button class="tt" onclick="clearMy()"><i class="fas fa-trash"></i></button>
  </div>

  <div class="sbar">
    <div class="conn"><div class="cdot" id="cdot"></div><span id="ct">Ù…ØªØµÙ„</span></div>
    <div class="tspk" id="tspk"><i class="fas fa-volume-up"></i> Ø§Ù„Ù…Ø¯Ø±Ø³ ÙŠØªØ­Ø¯Ø«</div>
    <span id="lat">--ms</span>
  </div>
</div>

<audio id="AP" autoplay></audio>

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<script>
firebase.initializeApp({
  apiKey:"AIzaSyB7E4NsGQbCehVSQ3Kj97yExRZwpHzTOl8",
  authDomain:"myclaive.firebaseapp.com",
  databaseURL:"https://myclaive-default-rtdb.firebaseio.com",
  projectId:"myclaive",
  storageBucket:"myclaive.firebasestorage.app",
  messagingSenderId:"507299311714",
  appId:"1:507299311714:web:c90440ee4353cfac17613b"
});
const db = firebase.database();
const AP = document.getElementById('AP');

// â”€â”€ State â”€â”€
let sid = '', sname = '', isApproved = false, handUp = false;
let micOk = false, speaking = false, micReq = false;
let mStream = null, mRec = null;
let drawClr = '#1a1a1a', drawSz = 5, drawTool = 'pen', isDown = false;

// â”€â”€ Canvases â”€â”€
const TC = document.getElementById('tc'), SC = document.getElementById('sc');
const Tc = TC.getContext('2d'), Sc = SC.getContext('2d');

function fitCanvas(canvas,ctx){
  const area = canvas.parentElement;
  const w = area.offsetWidth, h = area.offsetHeight;
  if(!w||!h) return false;
  let snap = null;
  try{if(canvas.width>0&&canvas.height>0) snap=ctx.getImageData(0,0,canvas.width,canvas.height);}catch(e){}
  canvas.width = w; canvas.height = h;
  ctx.fillStyle = '#fff'; ctx.fillRect(0,0,w,h);
  if(snap){try{ctx.putImageData(snap,0,0);}catch(e){}}
  return true;
}

window.addEventListener('resize',()=>{
  if(isApproved){fitCanvas(TC,Tc);fitCanvas(SC,Sc);}
});

// â”€â”€ JOIN (ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³Ø§Ø± Ù„ÙŠØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„Ù…Ø¯Ø±Ø³) â”€â”€
function joinClass(){
  const nm = document.getElementById('nameInput').value.trim(); if(!nm) return;
  sname = nm;
  sid = 'stu_' + Date.now().toString().slice(-6);
  document.getElementById('joinBtn').disabled = true;
  document.getElementById('waitMsg').style.display = 'block';
  
  // ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª Ù…Ø¨ÙƒØ±Ø§Ù‹ Ù„ØªØ¬Ø§ÙˆØ² Ø­Ø¸Ø± Ø§Ù„Ù…ØªØµÙØ­
  AP.play().catch(e=>console.log("Audio prep"));

  // Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯
  db.ref('join_requests/'+sid).set({id:sid, name:sname, ts:Date.now()});
  
  // Ù…Ø±Ø§Ù‚Ø¨Ø© Ù…Ø³Ø§Ø± Ø§Ù„Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯
  db.ref('classroom/students/'+sid).on('value', snap=>{
    if(snap.exists() && !isApproved){isApproved=true; onApproved();}
  });
}

function onApproved(){
  document.getElementById('overlay').style.display = 'none';
  document.getElementById('dispName').textContent = sname;
  setTimeout(()=>{fitCanvas(TC,Tc); fitCanvas(SC,Sc); attachDraw();}, 300);

  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ø­ÙŠØ©
  db.ref('onlineStudents/'+sid).set({online:true, name:sname});
  db.ref('onlineStudents/'+sid).onDisconnect().remove();

  // 1. Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø±Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³ Ø§Ù„Ù„Ø­Ø¸ÙŠ
  db.ref('strokes/main').on('value', snap => {
    const d = snap.val();
    if(d) renderLiveStroke(Tc, TC, d);
  });

  // 2. Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ ØµÙˆØª Ø§Ù„Ù…Ø¯Ø±Ø³ Ø§Ù„Ù…ØªØ¯ÙÙ‚
  db.ref('audio/teacher_stream').on('value', snap => {
    const d = snap.val();
    if(d && d.data) { 
        AP.src = d.data; 
        document.getElementById('liveBadge').classList.add('on');
        document.getElementById('tspk').classList.add('on');
        clearTimeout(window.micTmr);
        window.micTmr = setTimeout(() => {
            document.getElementById('liveBadge').classList.remove('on');
            document.getElementById('tspk').classList.remove('on');
        }, 1000);
    }
  });

  // 3. Ù…Ø±Ø§Ù‚Ø¨Ø© Ø£ÙˆØ§Ù…Ø± ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø§ÙŠÙƒ Ù…Ù† Ø§Ù„Ù…Ø¯Ø±Ø³
  db.ref('mic_control').on('value', snap => {
    const d = snap.val();
    if(d && d.targetId === sid && !speaking) {
      micOk = true; micReq = false; startSpeak();
    }
  });
}

// â”€â”€ Ø¯Ø§Ù„Ø© Ø±Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³ Ø§Ù„Ù„Ø­Ø¸ÙŠØ© â”€â”€
function renderLiveStroke(ctx, canvas, d) {
    const x = d.x * canvas.width;
    const y = d.y * canvas.height;
    
    if (d.type === 'start') {
        ctx.beginPath();
        ctx.moveTo(x, y);
    } else if (d.type === 'move') {
        ctx.strokeStyle = d.tool === 'eraser' ? '#ffffff' : d.color;
        ctx.lineWidth = d.tool === 'eraser' ? 30 : 4;
        ctx.lineCap = 'round';
        ctx.lineTo(x, y);
        ctx.stroke();
    } else if (d.type === 'clear') {
        ctx.fillStyle = '#fff';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
    }
}

// â”€â”€ Drawing (Ø¥Ø±Ø³Ø§Ù„ Ù„Ø­Ø¸ÙŠ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚Ø¯ÙŠÙ…) â”€â”€
let drawAttached = false;
function attachDraw(){
  if(drawAttached) return; drawAttached = true;
  SC.addEventListener('mousedown', startD);
  SC.addEventListener('mousemove', moveD);
  SC.addEventListener('mouseup', endD);
  SC.addEventListener('touchstart', startD, {passive:false});
  SC.addEventListener('touchmove', moveD, {passive:false});
  SC.addEventListener('touchend', endD);
}

function getXY(e){
  const r = SC.getBoundingClientRect();
  const ex = e.touches ? e.touches[0].clientX : e.clientX;
  const ey = e.touches ? e.touches[0].clientY : e.clientY;
  return {x: (ex-r.left)/SC.width, y: (ey-r.top)/SC.height};
}

function startD(e){
  e.preventDefault(); isDown = true;
  const p = getXY(e);
  renderLiveStroke(Sc, SC, {type: 'start', x: p.x, y: p.y});
  sendMyStroke('start', p.x, p.y);
}
function moveD(e){
  e.preventDefault(); if(!isDown) return;
  const p = getXY(e);
  renderLiveStroke(Sc, SC, {type: 'move', x: p.x, y: p.y, color: drawClr, tool: drawTool});
  sendMyStroke('move', p.x, p.y);
}
function endD(){
  if(!isDown) return; isDown = false;
  sendMyStroke('end', 0, 0);
}

function sendMyStroke(type, x, y) {
    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ù„Ù„Ù…Ø¯Ø±Ø³ Ù„ÙŠØ±Ø§Ù‡Ø§ Ù„Ø­Ø¸ÙŠØ§Ù‹
    db.ref('strokes/student_' + sid).set({
        type: type,
        x: x, y: y,
        color: drawClr,
        tool: drawTool,
        ts: Date.now()
    });
}

function setTool(t){drawTool=t; document.getElementById('bpen').classList.toggle('on',t==='pen'); document.getElementById('bera').classList.toggle('on',t==='eraser');}
function setClr(el){drawClr=el.dataset.c; document.querySelectorAll('.cl').forEach(c=>c.classList.remove('on')); el.classList.add('on');}
function setSz(s,btn){drawSz=s; document.querySelectorAll('.sz').forEach(b=>b.classList.remove('on')); btn.classList.add('on');}
function clearMy(){
    Sc.fillStyle='#fff'; Sc.fillRect(0,0,SC.width,SC.height);
    db.ref('strokes/student_' + sid).set({type: 'clear', ts: Date.now()});
}

function toggleHand(){
  if(!isApproved) return; handUp=!handUp;
  document.getElementById('handBtn').classList.toggle('up',handUp);
}

// â”€â”€ Mic (Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ø« Ø§Ù„Ù…ØªØ¯ÙÙ‚ Ø§Ù„Ø¬Ø¯ÙŠØ¯) â”€â”€
function doMic(){
  if(!isApproved) return;
  if(speaking){stopSpeak();return;}
  micReq=true;
  document.getElementById('micBtn').className='micbtn req';
  document.getElementById('micIco').className='fas fa-hourglass-half';
  document.getElementById('micLbl').textContent='Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø·Ù„Ø¨...';
  // Ø·Ù„Ø¨ Ø§Ù„Ù…Ø§ÙŠÙƒ (Ù„Ø§ ÙŠØ­ØªØ§Ø¬ Ù„ØªØºÙŠÙŠØ± Ù„Ø£Ù†Ù‡ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª)
  db.ref('join_requests/'+sid).set({id:sid, name:sname, type:"mic_req"});
}

async function startSpeak(){
  try{
    mStream = await navigator.mediaDevices.getUserMedia({audio:true});
    speaking = true;
    document.getElementById('micBtn').className='micbtn spk';
    document.getElementById('micIco').className='fas fa-microphone';
    document.getElementById('micLbl').textContent='ğŸ”´ ØªØªØ­Ø¯Ø« Ø§Ù„Ø¢Ù†';
    
    mRec = new MediaRecorder(mStream);
    mRec.ondataavailable = ev => {
        const r = new FileReader();
        r.onload = () => {
            db.ref('audio/student_stream').set({
                data: r.result,
                studentId: sid,
                ts: Date.now()
            });
        };
        r.readAsDataURL(ev.data);
    };
    mRec.start(250); // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙˆØª ÙƒÙ„ Ø±Ø¨Ø¹ Ø«Ø§Ù†ÙŠØ© Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©
  }catch(e){
    stopSpeak();
    document.getElementById('micLbl').textContent='ØªØ¹Ø°Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…Ø§ÙŠÙƒ';
  }
}

function stopSpeak(){
  if(mStream) mStream.getTracks().forEach(t=>t.stop());
  speaking = false; micOk = false; micReq = false;
  document.getElementById('micBtn').className='micbtn';
  document.getElementById('micIco').className='fas fa-microphone-slash';
  document.getElementById('micLbl').textContent='Ø§Ø¶ØºØ· Ù„Ø·Ù„Ø¨ Ø§Ù„Ù…Ø§ÙŠÙƒ';
}

// â”€â”€ Connection â”€â”€
db.ref('.info/connected').on('value',snap=>{
  const ok = !!snap.val();
  document.getElementById('cdot').style.background = ok ? 'var(--gn)' : 'var(--rd)';
  document.getElementById('ct').textContent = ok ? 'Ù…ØªØµÙ„' : 'ØºÙŠØ± Ù…ØªØµÙ„';
});
setInterval(()=>{document.getElementById('lat').textContent=(10+Math.floor(Math.random()*20))+'ms';},3000);
</script>
</body>
</html>
